<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>React Features</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Reagent</span> <span class="project-version">0.9.0-rc3</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="BatchingAndTiming.html"><div class="inner"><span>Batching and Timing: How Reagent Renders Changes to Application State</span></div></a></li><li class="depth-1 "><a href="CljsjsReactProblems.html"><div class="inner"><span>Question</span></div></a></li><li class="depth-1 "><a href="ComponentNotRerendering.html"><div class="inner"><span>## Question</span></div></a></li><li class="depth-1 "><a href="ControlledInputs.html"><div class="inner"><span>Controlled inputs</span></div></a></li><li class="depth-1 "><a href="CreatingReagentComponents.html"><div class="inner"><span>#### Not An Absolute Introduction</span></div></a></li><li class="depth-1 "><a href="InteropWithReact.html"><div class="inner"><span>Interop with React</span></div></a></li><li class="depth-1 "><a href="ManagingState.html"><div class="inner"><span>Managing state: atoms, cursors, Reactions, and tracking</span></div></a></li><li class="depth-1 "><a href="MyAttributesAreMissing.html"><div class="inner"><span>## Question</span></div></a></li><li class="depth-1 "><a href="README.html"><div class="inner"><span># Tutorials</span></div></a></li><li class="depth-1  current"><a href="ReactFeatures.html"><div class="inner"><span>React Features</span></div></a></li><li class="depth-1 "><a href="UsingAnEntity.html"><div class="inner"><span>## Question</span></div></a></li><li class="depth-1 "><a href="UsingHiccupToDescribeHTML.html"><div class="inner"><span>Using Hiccup to Describe HTML</span></div></a></li><li class="depth-1 "><a href="UsingRefs.html"><div class="inner"><span>## Question</span></div></a></li><li class="depth-1 "><a href="UsingSquareBracketsInsteadOfParens.html"><div class="inner"><span># Components</span></div></a></li><li class="depth-1 "><a href="WhenDoComponentsUpdate.html"><div class="inner"><span># Components Are Reactive</span></div></a></li><li class="depth-1 "><a href="dangerouslySetInnerHTML.html"><div class="inner"><span>## Question</span></div></a></li><li class="depth-1 "><a href="development.html"><div class="inner"><span>Reagent development</span></div></a></li><li class="depth-1 "><a href="material-ui.html"><div class="inner"><span>Material-UI</span></div></a></li><li class="depth-1 "><a href="smooth-ui.html"><div class="inner"><span>Smooth UI</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1 branch"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span></span></div></div></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>reagent</span></div></div></li><li class="depth-2 branch"><a href="reagent.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="reagent.debug.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>debug</span></div></a></li><li class="depth-2"><a href="reagent.dom.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dom</span></div></a></li><li class="depth-3"><a href="reagent.dom.server.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>server</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>impl</span></div></div></li><li class="depth-3 branch"><a href="reagent.impl.batching.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>batching</span></div></a></li><li class="depth-3 branch"><a href="reagent.impl.component.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>component</span></div></a></li><li class="depth-3 branch"><a href="reagent.impl.template.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>template</span></div></a></li><li class="depth-3"><a href="reagent.impl.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2 branch"><a href="reagent.interop.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>interop</span></div></a></li><li class="depth-2"><a href="reagent.ratom.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ratom</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><h1><a href="#react-features" name="react-features"></a>React Features</h1>
<p>Most React features should be usable from Reagent, even if Reagent doesn’t provide functions to use them directly.</p>
<h2><a href="#fragments" name="fragments"></a><a href="https://reactjs.org/docs/fragments.html">Fragments</a></h2>
<p>JSX:</p>
<pre><code class="js">function example() {
  return (
    &lt;React.Fragment&gt;
      &lt;ChildA /&gt;
      &lt;ChildB /&gt;
      &lt;ChildC /&gt;
    &lt;/React.Fragment&gt;
  );
}
</code></pre>
<p>Reagent:</p>
<pre><code class="cljs">(defn example []
  [:&lt;&gt;
   [child-a]
   [child-b]
   [child-c]])
</code></pre>
<p>Reagent syntax follows <a href="https://reactjs.org/docs/fragments.html#short-syntax">React Fragment short syntax</a>.</p>
<h2><a href="#context" name="context"></a><a href="https://reactjs.org/docs/context.html">Context</a></h2>
<pre><code class="cljs">(defonce my-context (react/createContext "default"))

(def Provider (.-Provider my-context))
(def Consumer (.-Consumer my-context))

(r/render [:&gt; Provider {:value "bar"}
           [:&gt; Consumer {}
            (fn [v]
              (r/as-element [:div "Context: " v]))]]
          container)
</code></pre>
<p>Tests contain example of using old React lifecycle Context API (<code>context-wrapper</code> function): <a href="https://github.com/reagent-project/reagent/blob/master/test/reagenttest/testreagent.cljs#L1141-L1165">tests</a></p>
<h2><a href="#error-boundaries" name="error-boundaries"></a><a href="https://reactjs.org/docs/error-boundaries.html">Error boundaries</a></h2>
<p><a href="https://reactjs.org/docs/react-component.html#static-getderivedstatefromerror">Relevant method docs</a></p>
<p>You can use <code>getDerivedStateFromError</code> (since React 16.6.0 and Reagent 0.9) (and <code>ComponentDidCatch</code>) lifecycle method with <code>create-class</code>:</p>
<pre><code class="cljs">(defn error-boundary [comp]
  (let [error (r/atom nil)]
    (r/create-class
      {:component-did-catch (fn [this e info])
       :get-derived-state-from-error (fn [e]
                                            (reset! error e)
                                            #js {})
       :reagent-render (fn [comp]
                          (if @error
                            [:div
                             "Something went wrong."
                             [:button {:on-click #(reset! error nil)} "Try again"]]
                            comp))})))
</code></pre>
<p>Alternatively, one could use React state instead of RAtom to keep track of error state, which can be more obvious with the new <code>getDerivedStateFromError</code> method:</p>
<pre><code class="cljs">(defn error-boundary [comp]
  (r/create-class
    {:constructor (fn [this props]
                    (set! (.-state this) #js {:error nil}))
     :component-did-catch (fn [this e info])
     :get-derived-state-from-error (fn [error] #js {:error error})
     :render (fn [this]
               (r/as-element
                 (if @error
                   [:div
                    "Something went wrong."
                    [:button {:on-click #(.setState this #js {:error nil})} "Try again"]]
                   (into [:&lt;&gt;] (r/children this)))})))
</code></pre>
<p>As per React docs, <code>getDerivedStateFromError</code> is what should update the state after error, it can be also used to update RAtom as in Reagent the Ratom is available in function closure even for static methods. <code>ComponentDidCatch</code> can be used for side-effects, like logging the error.</p>
<h2><a href="#hooks" name="hooks"></a><a href="https://reactjs.org/docs/hooks-intro.html">Hooks</a></h2>
<p>Hooks can’t be used inside class components, and Reagent implementation creates a class component from every function (i.e. Reagent component).</p>
<p>However, you can use React components using Hooks inside Reagent, or use <a href="https://github.com/Lokeh/hx">hx</a> components inside Reagent. Also, it is possible to create React components from Reagent quite easily, because React function component is just a function that happens to return React elements, and <code>r/as-element</code> does just that:</p>
<pre><code class="cljs">;; This is React function component. Can't use Ratoms here!
(defn example []
  (let [[count set-count] (react/useState 0)]
    (r/as-element
      [:div
       [:p "You clicked " count " times"]
       [:button
        {:on-click #(set-count inc)}
        "Click"]])))

;; Reagent component
(defn reagent-component []
  [:div
   ;; Note :&gt; to use a function as React component
   [:&gt; example]])
</code></pre>
<p>If you need to pass RAtom state into these components, dereference them in the Reagent components and pass the value (and if needed, function to update them) as properties into the React function component.</p>
<h2><a href="#portals" name="portals"></a><a href="https://reactjs.org/docs/portals.html">Portals</a></h2>
<pre><code class="cljs">(defn reagent-component []
  (r/create-class
    {:render (fn [this]
               (let [el (.. js/document (getElementById "portal-el"))]
                 (react-dom/createPortal (r/as-element [:div "foo"]) el)))}))

</code></pre>
<p>TODO: Can this be done without create-class and <code>:render</code>. TODO: This might have problems handling Ratoms, test.</p>
<h2><a href="#hydrate" name="hydrate"></a><a href="https://reactjs.org/docs/react-dom.html#hydrate">Hydrate</a></h2>
<pre><code class="cljs">(react-dom/hydrate (r/as-element [main-component]) container)
</code></pre></div></div></div></body></html>